05-25 08:05:59 model_name: CNN
05-25 08:05:59 Domain: exp
05-25 08:05:59 source: CWRU_0,CWRU_2
05-25 08:05:59 target: JNU_0
05-25 08:05:59 data_dir: ../burning_event/dataset
05-25 08:05:59 train_mode: source_combine
05-25 08:05:59 cuda_device: 0
05-25 08:05:59 save_dir: ./ckpt
05-25 08:05:59 max_epoch: 50
05-25 08:05:59 batch_size: 32
05-25 08:05:59 num_workers: 0
05-25 08:05:59 signal_size: 2048
05-25 08:05:59 random_state: 5
05-25 08:05:59 project: SWEEEEP
05-25 08:05:59 fac: 0
05-25 08:05:59 adv: 1
05-25 08:05:59 recon: 0
05-25 08:05:59 iet: 0
05-25 08:05:59 normlizetype: mean-std
05-25 08:05:59 opt: adam
05-25 08:05:59 lr: 0.001
05-25 08:05:59 momentum: 0.9
05-25 08:05:59 betas: (0.9, 0.999)
05-25 08:05:59 weight_decay: 0.001
05-25 08:05:59 lr_scheduler: stepLR
05-25 08:05:59 gamma: 0.2
05-25 08:05:59 steps: 20
05-25 08:05:59 tradeoff: ['exp', 'exp', 'exp']
05-25 08:05:59 dropout: 0.2
05-25 08:05:59 save: False
05-25 08:05:59 load_path:
05-25 08:05:59 tsne: False
05-25 08:05:59 save_path: ./ckpt/CNN/source_combine/[CWRU_0CWRU_2]To[JNU_0]_0525-080559
05-25 08:05:59 Detect 3 classes: ['inner', 'normal', 'outer']
05-25 08:06:00 using 1 / 2 gpus
05-25 08:06:02 Source set CWRU_0 number of samples 177.
05-25 08:06:02 Source set CWRU_2 number of samples 177.
Loading source: CWRU, Condition: 0
Source Data Distribution:
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |      59 |
| 1            |      59 |
| 2            |      59 |
| Dataset Size |     177 |
+--------------+---------+
Loading source: CWRU, Condition: 2
Source Data Distribution:
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |      59 |
| 1            |      59 |
| 2            |      59 |
| Dataset Size |     177 |
+--------------+---------+
Setting up target: JNU, Condition: 0
05-25 08:06:04 target training set number of samples 729.
05-25 08:06:04 target validation set number of samples 366.
05-25 08:06:04 -----Epoch 1/50-----
05-25 08:06:04 current lr: [0.001]
  0%|                                                                                                                                                                                                            | 0/22 [00:00<?, ?it/s]
Target Data Distribution:
+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |     243 |   122 |
| 1            |     243 |   122 |
| 2            |     243 |   122 |
| Dataset Size |     729 |   366 |
100%|###################################################################################################################################################################################################| 22/22 [00:01<00:00, 15.97it/s]
05-25 08:06:05 Train-Acc Source Data: 0.3338
05-25 08:06:05 Train-Loss Source Classifier: 1.0939
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 603.78it/s]
05-25 08:06:05 Val-Acc Target Data: 0.3177
05-25 08:06:05 The best model epoch 1, val-acc 0.3177
05-25 08:06:05 -----Epoch 2/50-----
05-25 08:06:05 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 238.01it/s]
05-25 08:06:05 Train-Acc Source Data: 0.3793
05-25 08:06:05 Train-Loss Source Classifier: 1.0862
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 605.96it/s]
05-25 08:06:05 Val-Acc Target Data: 0.3177
05-25 08:06:05 The best model epoch 2, val-acc 0.3177
05-25 08:06:05 -----Epoch 3/50-----
05-25 08:06:05 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 204.78it/s]
05-25 08:06:05 Train-Acc Source Data: 0.4986
05-25 08:06:05 Train-Loss Source Classifier: 1.0828
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 584.38it/s]
05-25 08:06:05 Val-Acc Target Data: 0.3177
05-25 08:06:05 The best model epoch 3, val-acc 0.3177
05-25 08:06:05 -----Epoch 4/50-----
05-25 08:06:05 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 225.31it/s]
05-25 08:06:06 Train-Acc Source Data: 0.5781
05-25 08:06:06 Train-Loss Source Classifier: 1.0803
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 600.38it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 4, val-acc 0.3177
05-25 08:06:06 -----Epoch 5/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 209.43it/s]
05-25 08:06:06 Train-Acc Source Data: 0.7386
05-25 08:06:06 Train-Loss Source Classifier: 1.0770
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 597.81it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 5, val-acc 0.3177
05-25 08:06:06 -----Epoch 6/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 205.53it/s]
05-25 08:06:06 Train-Acc Source Data: 0.8310
05-25 08:06:06 Train-Loss Source Classifier: 1.0751
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 598.65it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 6, val-acc 0.3177
05-25 08:06:06 -----Epoch 7/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 210.47it/s]
05-25 08:06:06 Train-Acc Source Data: 0.8935
05-25 08:06:06 Train-Loss Source Classifier: 1.0736
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 598.47it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 7, val-acc 0.3177
05-25 08:06:06 -----Epoch 8/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 214.02it/s]
05-25 08:06:06 Train-Acc Source Data: 0.9176
05-25 08:06:06 Train-Loss Source Classifier: 1.0721
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 581.28it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 8, val-acc 0.3177
05-25 08:06:06 -----Epoch 9/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 216.90it/s]
05-25 08:06:06 Train-Acc Source Data: 0.9545
05-25 08:06:06 Train-Loss Source Classifier: 1.0716
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 598.02it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 9, val-acc 0.3177
05-25 08:06:06 -----Epoch 10/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 215.36it/s]
05-25 08:06:06 Train-Acc Source Data: 0.9673
05-25 08:06:06 Train-Loss Source Classifier: 1.0705
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 603.65it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 10, val-acc 0.3177
05-25 08:06:06 -----Epoch 11/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 213.50it/s]
05-25 08:06:06 Train-Acc Source Data: 0.9602
05-25 08:06:06 Train-Loss Source Classifier: 1.0704
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 593.07it/s]
05-25 08:06:06 Val-Acc Target Data: 0.3177
05-25 08:06:06 The best model epoch 11, val-acc 0.3177
05-25 08:06:06 -----Epoch 12/50-----
05-25 08:06:06 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 208.19it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9744
05-25 08:06:07 Train-Loss Source Classifier: 1.0692
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 605.02it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 12, val-acc 0.3177
05-25 08:06:07 -----Epoch 13/50-----
05-25 08:06:07 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 210.09it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9815
05-25 08:06:07 Train-Loss Source Classifier: 1.0686
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 602.92it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 13, val-acc 0.3177
05-25 08:06:07 -----Epoch 14/50-----
05-25 08:06:07 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 216.82it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9858
05-25 08:06:07 Train-Loss Source Classifier: 1.0681
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 603.16it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 14, val-acc 0.3177
05-25 08:06:07 -----Epoch 15/50-----
05-25 08:06:07 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 217.69it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9886
05-25 08:06:07 Train-Loss Source Classifier: 1.0673
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 602.31it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 15, val-acc 0.3177
05-25 08:06:07 -----Epoch 16/50-----
05-25 08:06:07 current lr: [0.001]
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/lr_scheduler.py", line 65, in wrapper#######################################################################################################| 22/22 [00:00<00:00, 205.10it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9957
05-25 08:06:07 Train-Loss Source Classifier: 1.0670
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 596.11it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 16, val-acc 0.3177
05-25 08:06:07 -----Epoch 17/50-----
05-25 08:06:07 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 218.99it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9972
05-25 08:06:07 Train-Loss Source Classifier: 1.0669
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 601.44it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 17, val-acc 0.3177
05-25 08:06:07 -----Epoch 18/50-----
05-25 08:06:07 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 214.14it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9901
05-25 08:06:07 Train-Loss Source Classifier: 1.0662
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 600.17it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 18, val-acc 0.3177
05-25 08:06:07 -----Epoch 19/50-----
05-25 08:06:07 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 203.04it/s]
05-25 08:06:07 Train-Acc Source Data: 0.9943
05-25 08:06:07 Train-Loss Source Classifier: 1.0660
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 608.39it/s]
05-25 08:06:07 Val-Acc Target Data: 0.3177
05-25 08:06:07 The best model epoch 19, val-acc 0.3177
05-25 08:06:07 -----Epoch 20/50-----
05-25 08:06:07 current lr: [0.001]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 219.76it/s]
05-25 08:06:08 Train-Acc Source Data: 0.9972
05-25 08:06:08 Train-Loss Source Classifier: 1.0653
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 599.45it/s]
05-25 08:06:08 Val-Acc Target Data: 0.3177
05-25 08:06:08 The best model epoch 20, val-acc 0.3177
05-25 08:06:08 -----Epoch 21/50-----
05-25 08:06:08 current lr: [0.0002]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 214.59it/s]
05-25 08:06:08 Train-Acc Source Data: 0.9943
05-25 08:06:08 Train-Loss Source Classifier: 1.0642
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 607.22it/s]
05-25 08:06:08 Val-Acc Target Data: 0.3177
05-25 08:06:08 The best model epoch 21, val-acc 0.3177
05-25 08:06:08 -----Epoch 22/50-----
05-25 08:06:08 current lr: [0.0002]
100%|##################################################################################################################################################################################################| 22/22 [00:00<00:00, 218.49it/s]
05-25 08:06:08 Train-Acc Source Data: 0.9972
05-25 08:06:08 Train-Loss Source Classifier: 1.0629
100%|##################################################################################################################################################################################################| 12/12 [00:00<00:00, 522.92it/s]
05-25 08:06:08 Val-Acc Target Data: 0.3177
05-25 08:06:08 The best model epoch 22, val-acc 0.3177
05-25 08:06:08 -----Epoch 23/50-----
05-25 08:06:08 current lr: [0.0002]
 55%|#########################################################################################################8                                                                                        | 12/22 [00:00<00:00, 200.94it/s]
Traceback (most recent call last):
  File "train.py", line 87, in <module>
    trainer.train()
  File "/home/burning_event/models/CNN.py", line 84, in train
    self.optimizer.step()
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/lr_scheduler.py", line 65, in wrapper#######################################################################################################| 22/22 [00:00<00:00, 205.10it/s]
    return wrapped(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/optimizer.py", line 88, in wrapper
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/autograd/grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/optim/adam.py", line 128, in step
    grads.append(p.grad)
KeyboardInterrupt