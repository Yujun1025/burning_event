05-25 09:16:52 model_name: new
05-25 09:16:52 Domain: exp
05-25 09:16:52 source: CWRU_0,CWRU_2
05-25 09:16:52 target: JNU_2
05-25 09:16:52 data_dir: ../burning_event/dataset
05-25 09:16:52 train_mode: multi_source
05-25 09:16:52 cuda_device: 0
05-25 09:16:52 save_dir: ./ckpt
05-25 09:16:52 max_epoch: 50
05-25 09:16:52 batch_size: 32
05-25 09:16:52 num_workers: 0
05-25 09:16:52 signal_size: 2048
05-25 09:16:52 random_state: 5
05-25 09:16:52 project: SWEEEEP
05-25 09:16:52 fac: 0
05-25 09:16:52 adv: 1
05-25 09:16:52 recon: 0
05-25 09:16:52 iet: 0
05-25 09:16:52 normlizetype: mean-std
05-25 09:16:52 opt: adam
05-25 09:16:52 lr: 0.001
05-25 09:16:52 momentum: 0.9
05-25 09:16:52 betas: (0.9, 0.999)
05-25 09:16:52 weight_decay: 0.001
05-25 09:16:52 lr_scheduler: stepLR
05-25 09:16:52 gamma: 0.2
05-25 09:16:52 steps: 20
05-25 09:16:52 tradeoff: ['exp', 'exp', 'exp']
05-25 09:16:52 dropout: 0.2
05-25 09:16:52 save: False
05-25 09:16:52 load_path:
05-25 09:16:52 tsne: False
05-25 09:16:52 save_path: ./ckpt/new/multi_source/[CWRU_0CWRU_2]To[JNU_2]_0525-091652
05-25 09:16:52 Detect 3 classes: ['inner', 'normal', 'outer']
05-25 09:16:53 using 1 / 2 gpus
05-25 09:16:54 Source set CWRU_0 number of samples 177.
05-25 09:16:54 Source set CWRU_2 number of samples 177.
Loading source: CWRU, Condition: 0
Source Data Distribution:
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |      59 |
| 1            |      59 |
| 2            |      59 |
| Dataset Size |     177 |
+--------------+---------+
Loading source: CWRU, Condition: 2
Source Data Distribution:
+--------------+---------+
| Label        |   Count |
|--------------+---------|
| 0            |      59 |
| 1            |      59 |
| 2            |      59 |
| Dataset Size |     177 |
+--------------+---------+
Setting up target: JNU, Condition: 2
05-25 09:16:56 target training set number of samples 729.
05-25 09:16:56 target validation set number of samples 366.
05-25 09:16:56 -----Epoch 1/50-----
05-25 09:16:56 current lr: [0.001, 0.001, 0.001, 0.001, 0.001, 0.001]
  0%|                                                                                                                                                                     | 0/22 [00:01<?, ?it/s]
Traceback (most recent call last):
  File "train.py", line 87, in <module>
    trainer.train()
  File "/home/burning_event/models/new.py", line 211, in train
    loss_d = self.domain_adv(f_d1_1, f_d1_2, f_d1_4)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/burning_event/utils.py", line 297, in forward
    d = self.domain_discriminator(f)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/burning_event/./models/model_base.py", line 38, in forward
    y = self.net(input)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/usr/local/lib/python3.8/dist-packages/torch/nn/modules/module.py", line 1110, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/burning_event/./models/model_base.py", line 12, in forward
    return F.linear(input, normalized_weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (96x512 and 256x4)
Target Data Distribution:
+--------------+---------+-------+
|              |   train |   val |
|--------------+---------+-------|
| 0            |     243 |   122 |
| 1            |     243 |   122 |
| 2            |     243 |   122 |
| Dataset Size |     729 |   366 |
+--------------+---------+-------+